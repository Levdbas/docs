<p>Timber makes it damn easy to use an image in a tag.</p><p>Automatically, Timber will interpret images attached to a post’s thumbnail field (&quot;Featured Image&quot; in the admin) and treat them as instances of <a href="https://timber.github.io/docs/reference/timber-image/">Timber\Image</a>. Then, in your Twig templates, you can access them via <code>{{ post.thumbnail }}</code>.</p><h2 id="basic-image-stuff">Basic image stuff <a class="directLink" href="#basic-image-stuff">#</a></h2><p>Again, pretty damn easy:</p><pre class="language-twig"><code class="language-twig"><span class="token other">&lt;img src="</span><span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">post</span><span class="token punctuation">.</span><span class="token property">thumbnail</span><span class="token punctuation">.</span><span class="token property">src</span> <span class="token rd"><span class="token punctuation">}}</span></span></span><span class="token other">" class="my-thumb-class" alt="Image for</span> <span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">post</span><span class="token punctuation">.</span><span class="token property">title</span> <span class="token rd"><span class="token punctuation">}}</span></span></span><span class="token other">" /></span></code></pre><h2 id="use-a-wordpress-image-size">Use a WordPress image size <a class="directLink" href="#use-a-wordpress-image-size">#</a></h2><p>You can use WordPress image sizes (including ones you register with your theme/plugin) by passing the name of the size to <code>src</code> like so:</p><pre class="language-twig"><code class="language-twig"><span class="token other">&lt;img src="</span><span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">post</span><span class="token punctuation">.</span><span class="token property">thumbnail</span><span class="token punctuation">.</span><span class="token property">src</span><span class="token punctuation">(</span><span class="token string"><span class="token punctuation">'</span>medium<span class="token punctuation">'</span></span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">}}</span></span></span><span class="token other">" class="my-thumb-class" alt="Image for</span> <span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">post</span><span class="token punctuation">.</span><span class="token property">title</span> <span class="token rd"><span class="token punctuation">}}</span></span></span><span class="token other">" /></span></code></pre><p>Note: If the WordPress size (e.g <code>medium</code>) has not been generated, it will return an empty string.</p><h2 id="arbitrary-resizing-of-images">Arbitrary resizing of images <a class="directLink" href="#arbitrary-resizing-of-images">#</a></h2><p>Want to resize an image? Here we’re going to use <a href="http://twig.sensiolabs.org/doc/filters/index.html">Twig Filters</a>.</p><pre class="language-twig"><code class="language-twig"><span class="token other">&lt;img src="</span><span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">post</span><span class="token punctuation">.</span><span class="token property">thumbnail</span><span class="token punctuation">.</span><span class="token property">src</span><span class="token operator">|</span><span class="token property">resize</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">}}</span></span></span><span class="token other">" /></span></code></pre><p>The first parameter is <code>width</code>, the second is <code>height</code> (optional). So if you don’t know the height of the image, but still want to scale it proportionally, you can do:</p><pre class="language-twig"><code class="language-twig"><span class="token other">&lt;img src="</span><span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">post</span><span class="token punctuation">.</span><span class="token property">thumbnail</span><span class="token punctuation">.</span><span class="token property">src</span><span class="token operator">|</span><span class="token property">resize</span><span class="token punctuation">(</span><span class="token number">640</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">}}</span></span></span><span class="token other">" /></span></code></pre><p>All of these filters are written specifically to interact with WordPress’s image API. So don’t worry, no weird TimThumb stuff going on—this is all using WordPress’s internal image sizing stuff.</p><p>Be aware of the limitations of this function <a href="https://timber.github.io/docs/guides/cookbook-images/#limitations-when-working-with-a-cdn">when working with a CDN</a>.</p><h2 id="letterboxing-images">Letterboxing images <a class="directLink" href="#letterboxing-images">#</a></h2><p>Let’s say you have an image that you want to contain to a certain size without any cropping. If the proportions don’t fit you’ll letterbox the extra space. I find this is really useful when getting logos to all appear next to each other. You can do this with:</p><pre class="language-twig"><code class="language-twig"><span class="token other">&lt;img src="</span><span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">post</span><span class="token punctuation">.</span><span class="token property">thumbnail</span><span class="token punctuation">.</span><span class="token property">src</span><span class="token operator">|</span><span class="token property">letterbox</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token string"><span class="token punctuation">'</span>#FFFFFF<span class="token punctuation">'</span></span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">}}</span></span></span><span class="token other">" /></span></code></pre><p>Here <code>width</code> and <code>height</code> are required. The third argument is the background color in hex format (default is <code>#000000</code>).</p><h2 id="converting-images">Converting images <a class="directLink" href="#converting-images">#</a></h2><p>Let’s say your client or editor is a bit lazy and they resort to PNGs where only JPGs are required. We have all seen this a lot. People will just upload screenshots that are saved by default as PNGs. No problemo!</p><pre class="language-twig"><code class="language-twig"><span class="token other">&lt;img src="</span><span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">post</span><span class="token punctuation">.</span><span class="token property">thumbnail</span><span class="token punctuation">.</span><span class="token property">src</span><span class="token operator">|</span><span class="token property">tojpg</span> <span class="token rd"><span class="token punctuation">}}</span></span></span><span class="token other">" /></span></code></pre><p>You can use this in conjunction with other filters.</p><pre class="language-twig"><code class="language-twig"><span class="token other">&lt;img src="</span><span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">post</span><span class="token punctuation">.</span><span class="token property">thumbnail</span><span class="token punctuation">.</span><span class="token property">src</span><span class="token operator">|</span><span class="token property">tojpg</span><span class="token operator">|</span><span class="token property">resize</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">}}</span></span></span><span class="token other">" /></span></code></pre><p>Filters are executed from left to right. You’ll probably want to convert to JPG before running the resizing, etc.</p><h3 id="using-webp-images">Using WebP images <a class="directLink" href="#using-webp-images">#</a></h3><p>Similar to the <code>|tojpg</code> filter, there’s a <code>|towebp</code> filter.</p><pre class="language-twig"><code class="language-twig"><span class="token other"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>picture</span><span class="token punctuation">></span></span><br>   &lt;source srcset="</span><span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">post</span><span class="token punctuation">.</span><span class="token property">thumbnail</span><span class="token punctuation">.</span><span class="token property">src</span><span class="token operator">|</span><span class="token property">towebp</span> <span class="token rd"><span class="token punctuation">}}</span></span></span><span class="token other">" type="image/webp"><br>   &lt;source srcset="</span><span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">post</span><span class="token punctuation">.</span><span class="token property">thumbnail</span><span class="token punctuation">.</span><span class="token property">src</span><span class="token operator">|</span><span class="token property">tojpg</span> <span class="token rd"><span class="token punctuation">}}</span></span></span><span class="token other">" type="image/jpeg"><br>   &lt;img src="</span><span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">post</span><span class="token punctuation">.</span><span class="token property">thumbnail</span><span class="token punctuation">.</span><span class="token property">src</span><span class="token operator">|</span><span class="token property">tojpg</span> <span class="token rd"><span class="token punctuation">}}</span></span></span><span class="token other">" alt="</span><span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">post</span><span class="token punctuation">.</span><span class="token property">title</span> <span class="token rd"><span class="token punctuation">}}</span></span></span><span class="token other">"><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>picture</span><span class="token punctuation">></span></span></span></code></pre><h2 id="generating-retina-sizes">Generating retina sizes <a class="directLink" href="#generating-retina-sizes">#</a></h2><p>You can use Timber to generate @2x image sizes for retina devices. For example, using <code>srcset</code>:</p><pre class="language-twig"><code class="language-twig"><span class="token other">&lt;img src="</span><span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">post</span><span class="token punctuation">.</span><span class="token property">thumbnail</span><span class="token punctuation">.</span><span class="token property">src</span> <span class="token rd"><span class="token punctuation">}}</span></span></span><span class="token other">" srcset="</span><span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">post</span><span class="token punctuation">.</span><span class="token property">thumbnail</span><span class="token punctuation">.</span><span class="token property">src</span><span class="token operator">|</span><span class="token property">retina</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">}}</span></span></span> <span class="token other">1x,</span><br>    <span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">post</span><span class="token punctuation">.</span><span class="token property">thumbnail</span><span class="token punctuation">.</span><span class="token property">src</span><span class="token operator">|</span><span class="token property">retina</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">}}</span></span></span> <span class="token other">2x,</span><br>    <span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">post</span><span class="token punctuation">.</span><span class="token property">thumbnail</span><span class="token punctuation">.</span><span class="token property">src</span><span class="token operator">|</span><span class="token property">retina</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">}}</span></span></span> <span class="token other">3x,</span><br>    <span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">post</span><span class="token punctuation">.</span><span class="token property">thumbnail</span><span class="token punctuation">.</span><span class="token property">src</span><span class="token operator">|</span><span class="token property">retina</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">}}</span></span></span> <span class="token other">4x"></span></code></pre><p>Unfortunately, it’s not possible to use the <code>|retina()</code> filter in combination with <code>|resize()</code>, because it would create an upscaled image. We are working on making this work eventually.</p><h2 id="using-images-in-custom-fields">Using images in custom fields <a class="directLink" href="#using-images-in-custom-fields">#</a></h2><p>Let’s say you're using a custom field plugin (like the amazing <a href="http://www.advancedcustomfields.com/">Advanced Custom Fields</a>). You can use the resulting images in your Twig templates very easily.</p><p>When setting up your custom fields you’ll want to save the <code>image_id</code> to the field. The image object, url, etc. <em>will</em> work but it’s not as fool-proof.</p><h3 id="the-quick-way-for-most-situations">The quick way (for most situations) <a class="directLink" href="#the-quick-way-for-most-situations">#</a></h3><pre class="language-twig"><code class="language-twig"><span class="token tag"><span class="token ld"><span class="token punctuation">{%</span> <span class="token keyword">set</span></span> <span class="token property">image</span> <span class="token operator">=</span> <span class="token property">Image</span><span class="token punctuation">(</span><span class="token property">post</span><span class="token punctuation">.</span><span class="token property">hero_image</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">%}</span></span></span><br><br><span class="token other">&lt;img src="</span><span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">image</span><span class="token punctuation">.</span><span class="token property">src</span> <span class="token rd"><span class="token punctuation">}}</span></span></span><span class="token other">" alt="</span><span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">image</span><span class="token punctuation">.</span><span class="token property">alt</span> <span class="token rd"><span class="token punctuation">}}</span></span></span><span class="token other">" /></span></code></pre><h3 id="the-long-way-for-some-special-situations">The long way (for some special situations) <a class="directLink" href="#the-long-way-for-some-special-situations">#</a></h3><p>This is where we’ll start in PHP.</p><p><strong>single.php</strong></p><pre class="language-php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><br><span class="token variable">$post</span> <span class="token operator">=</span> Timber<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">get_post</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token keyword">isset</span><span class="token punctuation">(</span> <span class="token variable">$post</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">hero_image</span> <span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">strlen</span><span class="token punctuation">(</span> <span class="token variable">$post</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">hero_image</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token variable">$post</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">hero_image</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Timber<span class="token punctuation">\</span>Image</span><span class="token punctuation">(</span> <span class="token variable">$post</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">hero_image</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token variable">$data</span> <span class="token operator">=</span> Timber<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token variable">$data</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'post'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$post</span><span class="token punctuation">;</span><br>Timber<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">render</span><span class="token punctuation">(</span> <span class="token single-quoted-string string">'single.twig'</span><span class="token punctuation">,</span> <span class="token variable">$data</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p><code>Timber\Image</code> should be initialized using a WordPress image ID. It can also take URLs and image objects, but that requires extra processing.</p><p>You can now use all the above functions to transform your custom images in the same way. The format will be:</p><pre class="language-twig"><code class="language-twig"><span class="token other">&lt;img src="</span><span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">post</span><span class="token punctuation">.</span><span class="token property">hero_image</span><span class="token punctuation">.</span><span class="token property">src</span><span class="token operator">|</span><span class="token property">resize</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span> <span class="token rd"><span class="token punctuation">}}</span></span></span><span class="token other">" /></span></code></pre><h2 id="limitations-when-working-with-a-cdn">Limitations when working with a CDN <a class="directLink" href="#limitations-when-working-with-a-cdn">#</a></h2><p>Timber’s image functions may be somewhat limited when using a CDN. There are <a href="https://cdn.net/push-vs-pull-cdn/">differences between Pull CDN and Push CDN</a>.</p><h3 id="using-a-pull-cdn">Using a Pull CDN <a class="directLink" href="#using-a-pull-cdn">#</a></h3><p>You should be <strong>fine when you use a Pull CDN</strong>, because there, you pass in which directories of your website you want to map to your CDN. The links to assets in those directories will be automatically replaced with the links to the CDN in the resulting HTML. The Pull CDN will «pull» these files to the server, if they don’t exist yet.</p><h3 id="using-a-push-cdn">Using a Push CDN <a class="directLink" href="#using-a-push-cdn">#</a></h3><p>When you use a Push CDN, you need to be aware of the following limitation:</p><p><strong>When you use a filter that creates a new image</strong>, like <code>|resize()</code>, <code>|letterbox()</code> or <strong>a filter that converts your image to another format</strong>, like <code>|tojpg</code> or <code>|towebp</code>, it probably won’t work. With these filters, Timber creates a new file locally. But WordPress doesn’t know about that file, because it’s not associated with a WordPress image size registered through <code>add_image_size()</code>. Because of that, some CDN plugins will not be able to upload/push that image to the CDN server, because they don’t know the file exists, either.</p><p><strong>You are safe if you use</strong> <code>{{ image.src }}</code> or if you get the source of a WordPress image size, like <code>{{ image.src('large') }}</code>.</p><p>Examples for plugins that work with Push CDN:</p><ul><li><a href="https://wordpress.org/plugins/amazon-s3-and-cloudfront/">WP Offload Media Lite</a></li></ul>