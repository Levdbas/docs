<h2 id="universal-escaping">Universal Escaping <a class="directLink" href="#universal-escaping">#</a></h2><p>By default, Timber does <em>not</em> escape the output of standard tags (i.e. <code>{{ post.field }}</code>). If you want to enable <code>autoescape</code> behavior simply add these lines to <code>functions.php</code>:</p><pre class="language-php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">class_exists</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Timber'</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span><br>	Timber<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token variable">$autoescape</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'html'</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><h2 id="general-escapers">General Escapers <a class="directLink" href="#general-escapers">#</a></h2><p>Twig offers a variety of <a href="http://twig.sensiolabs.org/doc/filters/escape.html">escapers</a> out of the box. These are intended to escape a string for safe insertion into the final output and there are multiple functions to conform to the strategy dependant on the context. In addition, Timber has added some valuable custom escapers for your WP theme. To use the escaper (see documentation link above) you use pipe your content through a function <code>e</code> if you want to use a custom escaper you would supply an argument to the function, e.g. <code>e('wp_kses_post')</code></p><p>This all follows the WordPress (and greater development philosophy) to:</p><ol><li>Never trust user input.</li><li>Escape as late as possible.</li><li>Escape everything from untrusted sources (like databases and users), third-parties (like Twitter), etc.</li><li>Never assume anything.</li><li>Never trust user input.</li><li>Sanitation is okay, but validation/rejection is better.</li><li>Never trust user input.</li></ol><p><a href="https://vip.wordpress.com/documentation/vip/best-practices/security/validating-sanitizing-escaping/">Relevant Documentation</a></p><h2 id="wp_kses_post">wp_kses_post <a class="directLink" href="#wp_kses_post">#</a></h2><p>Background on KSES. KSES is a recursive acronym for <code>KSES Kills Evil Scripts</code>. It's goal is to ensure only &quot;allowed&quot; HTML element names, attribute names and attribute values plus only sane HTML entities in the string. Allowed is based on a configuration.</p><p>This uses ths internal WordPress method that sanitize content for allowed HTML tags for post content. The configuration used can be found by running <code>wp_kses_allowed_html( 'post' );</code> <a href="https://codex.wordpress.org/Function_Reference/wp_kses_post">WordPress Documentation</a></p><p><strong>Twig</strong></p><p><code>&lt;p class=&quot;intro&quot;&gt;{{post.post_content|e('wp_kses_post')}}&lt;/p&gt;</code></p><p>In this example, <code>post.post_content</code> is:</p><p><code>&lt;div foo=&quot;bar&quot; src=&quot;bum&quot;&gt;Foo&lt;/div&gt;&lt;script&gt;DoEvilThing();&lt;/script&gt;</code></p><p><strong>Output</strong></p><p><code>&lt;div&gt;Foo&lt;/div&gt;DoEvilThing();</code></p><hr><h2 id="esc_url">esc_url <a class="directLink" href="#esc_url">#</a></h2><p>Uses WordPress' internal <code>esc_url</code> function on text. This should be used to sanitize URLs. <a href="https://codex.wordpress.org/Function_Reference/esc_url">WordPress Documentation</a></p><p><strong>Twig</strong></p><p><code>&lt;a href=&quot;{{ post.get_field('custom_link')|e('esc_url') }}&quot;&gt;&lt;/a&gt;</code></p><p><strong>Output</strong></p><p><code>&lt;a href=&quot;http://google.com&quot;&gt;&lt;/a&gt;</code></p><hr><h2 id="esc_html">esc_html <a class="directLink" href="#esc_html">#</a></h2><p>Escaping for HTML blocks. It converts any potentially conflicting HTML entities to their encoded equivalent to prevent them from being rendered as markup by the browser, e.g. converts &quot;&lt;&quot; to &quot;&lt;&quot; and double quotes &quot; to &quot;$quot;&quot;</p><p>This is for plain old text. If your content has HTML markup you should not use <code>esc_html</code> which will render the HTML as it looks in your code editor -- to preserve the HTML you will want to use <code>wp_kses_post</code></p><p><strong>Twig</strong></p><p><code>&lt;div class=&quot;equation&quot;&gt;{{ post.get_field('equation')|e('esc_html') }}&lt;/div&gt;</code></p><p><strong>Output</strong></p><p><code>&lt;div class=&quot;equation&quot;&gt;is x &amp;lt; y?&lt;/div&gt;</code></p><hr><h2 id="esc_js">esc_js <a class="directLink" href="#esc_js">#</a></h2><p>Escapes text strings for echoing in JS. It is intended to be used for inline JS (in a tag attribute, for example onclick=”…”). Note that the strings have to be in single quotes. The filter ‘js_escape’ is also applied.</p><p><strong>Twig</strong></p><p><code>&lt;script&gt;var bar = '{{ post.get_field('name') }}';&lt;/script&gt;</code></p><p><strong>Output</strong></p><p><code>&lt;script&gt;var bar = 'Gabrielle';&lt;/script&gt;</code></p>