<p>Myth: Timber is for making simple themes. Fact: It's for making incredibly complex themes <em>look</em> easy. But yes, you can also make simple sites from it.</p><p>The beauty of Timber is that the object-oriented nature lets you extend it to match the exact requirements of your theme.</p><h2 id="an-example-that-extends-timberpost">An example that extends TimberPost <a class="directLink" href="#an-example-that-extends-timberpost">#</a></h2><p>Timber's objects like <code>Timber\Post</code>, <code>Timber\Term</code>, etc. are a great starting point to build your own subclass from. For example, on this project each post was a part of an &quot;issue&quot; of a magazine. I wanted an easy way to reference the issue in the twig file:</p><pre class="language-twig"><code class="language-twig"><span class="token other"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span></span><span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">post</span><span class="token punctuation">.</span><span class="token property">title</span> <span class="token rd"><span class="token punctuation">}}</span></span></span><span class="token other"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">></span></span>From the</span> <span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">post</span><span class="token punctuation">.</span><span class="token property">issue</span><span class="token punctuation">.</span><span class="token property">title</span> <span class="token rd"><span class="token punctuation">}}</span></span></span> <span class="token other">issue<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">></span></span></span></code></pre><p>Of course, <code>Timber\Post</code> has no built-in concept of an issue (which I've built as a custom taxonomy called &quot;issues&quot;). So we're going to extend TimberPost to give it one:</p><pre class="language-php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><br><span class="token keyword">class</span> <span class="token class-name">MySitePost</span> <span class="token keyword">extends</span> <span class="token class-name">Timber<span class="token punctuation">\</span>Post</span> <span class="token punctuation">{</span><br><br>	<span class="token keyword">var</span> <span class="token variable">$_issue</span><span class="token punctuation">;</span><br><br>	<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">issue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>		<span class="token variable">$issues</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">get_terms</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'issues'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$issues</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$issues</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>			<span class="token keyword">return</span> <span class="token variable">$issues</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>		<span class="token punctuation">}</span><br>	<span class="token punctuation">}</span><br><span class="token punctuation">}</span></span></code></pre><p>So now I've got an easy way to refer to the {{ post.issue }} in our twig templates. If you want to make this production-ready I recommend a bit of internal caching so that you don't re-query every time you need to get the issue data:</p><pre class="language-php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><br><span class="token keyword">class</span> <span class="token class-name">MySitePost</span> <span class="token keyword">extends</span> <span class="token class-name">Timber<span class="token punctuation">\</span>Post</span> <span class="token punctuation">{</span><br><br>	<span class="token keyword">var</span> <span class="token variable">$_issue</span><span class="token punctuation">;</span><br><br>	<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">issue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_issue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>			<span class="token variable">$issues</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">get_terms</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'issues'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$issues</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$issues</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>				<span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_issue</span> <span class="token operator">=</span> <span class="token variable">$issues</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>			<span class="token punctuation">}</span><br>		<span class="token punctuation">}</span><br>		<span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_issue</span><span class="token punctuation">;</span><br>	<span class="token punctuation">}</span><br><span class="token punctuation">}</span></span></code></pre><p>Right now I'm in the midst of building a complex site for a hybrid foundation and publication. The posts on the site have some very specific requirements that requires a fair amount of logic. I can take the simple <code>Timber\Post</code> object and extend it to make it work perfectly for this theme.</p><p>For example, I have a plugin that let's people insert manually related posts, but if they don't, WordPress will pull some automatically based on how the post is tagged.</p><pre class="language-php"><code class="language-php">	<span class="token php language-php"><span class="token delimiter important">&lt;?php</span><br>	<span class="token keyword">class</span> <span class="token class-name">MySitePost</span> <span class="token keyword">extends</span> <span class="token class-name">Timber<span class="token punctuation">\</span>Post</span> <span class="token punctuation">{</span><br><br>		<span class="token keyword">function</span> <span class="token function">get_related_auto</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>			<span class="token variable">$tags</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">tags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$tags</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$tags</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>				<span class="token variable">$search_tag</span> <span class="token operator">=</span> <span class="token variable">$tags</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>				<span class="token variable">$related</span> <span class="token operator">=</span> Timber<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">get_posts</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'tag_id='</span><span class="token punctuation">.</span><span class="token variable">$search_tag</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">ID</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>				<span class="token keyword">return</span> <span class="token variable">$related</span><span class="token punctuation">;</span><br>			<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>				<span class="token comment">//not tagged, cant do related on it</span><br>				<span class="token keyword">return</span> <span class="token boolean constant">false</span><span class="token punctuation">;</span><br>			<span class="token punctuation">}</span><br>		<span class="token punctuation">}</span><br><br>		<span class="token keyword">function</span> <span class="token function">get_related_manual</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">related_manual</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">related_manual</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><br>				<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">related_manual</span> <span class="token keyword">as</span> <span class="token operator">&amp;</span><span class="token variable">$related</span><span class="token punctuation">)</span><span class="token punctuation">{</span><br>					<span class="token variable">$related</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MySitePost</span><span class="token punctuation">(</span><span class="token variable">$related</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>				<span class="token punctuation">}</span><br>				<span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">related_manual</span><span class="token punctuation">;</span><br>			<span class="token punctuation">}</span><br>			<span class="token keyword">return</span> <span class="token boolean constant">false</span><span class="token punctuation">;</span><br>		<span class="token punctuation">}</span><br><br>		<span class="token keyword">function</span> <span class="token function">related</span><span class="token punctuation">(</span><span class="token variable">$limit</span> <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>			<span class="token variable">$related</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">get_related_manual</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$related</span><span class="token punctuation">)</span><span class="token punctuation">{</span><br>				<span class="token variable">$related</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">get_related_auto</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>			<span class="token punctuation">}</span><br>			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$related</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>				<span class="token function">array_splice</span><span class="token punctuation">(</span><span class="token variable">$related</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token variable">$limit</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>			<span class="token punctuation">}</span><br>			<span class="token keyword">return</span> <span class="token variable">$related</span><span class="token punctuation">;</span><br>		<span class="token punctuation">}</span><br>	<span class="token punctuation">}</span></span></code></pre><p>These can get pretty complex. And that's the beauty. The complexity lives inside the context of the object, but very simple when it comes to your templates.</p><h2 id="adding-functionality-to-twig">Adding functionality to Twig <a class="directLink" href="#adding-functionality-to-twig">#</a></h2><p>You can extend Twig by adding custom functionality like functions or filters. Timber provides its own classes (<code>Timber\Twig_Function</code> and <code>Timber\Twig_Filter</code>) to provide better compatibility with different versions of Twig.</p><p><strong>functions.php</strong></p><pre class="language-php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><br><br><span class="token function">add_filter</span><span class="token punctuation">(</span> <span class="token single-quoted-string string">'timber/twig'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'add_to_twig'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">/**<br> * Adds functionality to Twig.<br> * <br> * @param \Twig\Environment $twig The Twig environment.<br> * @return \Twig\Environment<br> */</span><br><span class="token keyword">function</span> <span class="token function">add_to_twig</span><span class="token punctuation">(</span> <span class="token variable">$twig</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token comment">// Adding a function.</span><br>    <span class="token variable">$twig</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">addFunction</span><span class="token punctuation">(</span> <span class="token keyword">new</span> <span class="token class-name">Timber<span class="token punctuation">\</span>Twig_Function</span><span class="token punctuation">(</span> <span class="token single-quoted-string string">'edit_post_link'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'edit_post_link'</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <br>    <span class="token comment">// Adding functions as filters.</span><br>    <span class="token variable">$twig</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">addFilter</span><span class="token punctuation">(</span> <span class="token keyword">new</span> <span class="token class-name">Timber<span class="token punctuation">\</span>Twig_Filter</span><span class="token punctuation">(</span> <span class="token single-quoted-string string">'whateverify'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'whateverify'</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token variable">$twig</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">addFilter</span><span class="token punctuation">(</span> <span class="token keyword">new</span> <span class="token class-name">Timber<span class="token punctuation">\</span>Twig_Filter</span><span class="token punctuation">(</span> <span class="token single-quoted-string string">'slugify'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token variable">$title</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">return</span> <span class="token function">sanitize_title</span><span class="token punctuation">(</span> <span class="token variable">$title</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <br>    <span class="token keyword">return</span> <span class="token variable">$twig</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">function</span> <span class="token function">whateverify</span><span class="token punctuation">(</span> <span class="token variable">$text</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token variable">$text</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token single-quoted-string string">' or whatever'</span><span class="token punctuation">;</span><br>    <br>    <span class="token keyword">return</span> <span class="token variable">$text</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></span></code></pre><p>This can now be called in your twig files with:</p><pre class="language-twig"><code class="language-twig"><span class="token other">&lt;h2 id="</span><span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">post</span><span class="token punctuation">.</span><span class="token property">title</span><span class="token operator">|</span><span class="token property">slugify</span> <span class="token rd"><span class="token punctuation">}}</span></span></span><span class="token other">"></span><span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">post</span><span class="token punctuation">.</span><span class="token property">title</span><span class="token operator">|</span><span class="token property">whateverify</span> <span class="token rd"><span class="token punctuation">}}</span></span></span><span class="token other"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span></span></code></pre><p>Which will output:</p><pre class="language-twig"><code class="language-twig"><span class="token other"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>hello-world<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Hello World! or whatever<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span></span></code></pre>