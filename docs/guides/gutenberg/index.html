<h2 id="using-gutenberg-with-timber">Using Gutenberg with Timber <a class="directLink" href="#using-gutenberg-with-timber">#</a></h2><p>Timber works with Gutenberg out of the box. If you use <code>{{ post.content }}</code>, Timber will render all the Gutenberg blocks.</p><h2 id="acf-blocks">ACF Blocks <a class="directLink" href="#acf-blocks">#</a></h2><h3 id="what-are-acf-blocks?">What are ACF Blocks? <a class="directLink" href="#what-are-acf-blocks?">#</a></h3><p>ACF Blocks are an alternative way to create content blocks without advanced JavaScript knowledge. If you want to learn more about them, read the article on <a href="https://www.advancedcustomfields.com/blog/acf-5-8-introducing-acf-blocks-for-gutenberg/">advancedcustomfields.com</a>.</p><h3 id="how-to-use-acf-blocks-with-timber">How to use ACF Blocks with Timber <a class="directLink" href="#how-to-use-acf-blocks-with-timber">#</a></h3><p>Before you can start using ACF Blocks, you must install the Advanced Custom Fields 5.8.0-beta version or later.</p><p>To create a content block, you first have to register it in <strong>functions.php</strong> or in a separate plugin:</p><pre class="language-php"><code class="language-php"><span class="token function">add_action</span><span class="token punctuation">(</span> <span class="token single-quoted-string string">'acf/init'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'my_acf_init'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">function</span> <span class="token function">my_acf_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token comment">// Bail out if function doesnâ€™t exist.</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span> <span class="token function">function_exists</span><span class="token punctuation">(</span> <span class="token single-quoted-string string">'acf_register_block'</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">return</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// Register a new block.</span><br>    <span class="token function">acf_register_block</span><span class="token punctuation">(</span> <span class="token keyword">array</span><span class="token punctuation">(</span><br>        <span class="token single-quoted-string string">'name'</span>            <span class="token operator">=</span><span class="token operator">></span> <span class="token single-quoted-string string">'example_block'</span><span class="token punctuation">,</span><br>        <span class="token single-quoted-string string">'title'</span>           <span class="token operator">=</span><span class="token operator">></span> <span class="token function">__</span><span class="token punctuation">(</span> <span class="token single-quoted-string string">'Example Block'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'your-text-domain'</span> <span class="token punctuation">)</span><span class="token punctuation">,</span><br>        <span class="token single-quoted-string string">'description'</span>     <span class="token operator">=</span><span class="token operator">></span> <span class="token function">__</span><span class="token punctuation">(</span> <span class="token single-quoted-string string">'A custom example block.'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'your-text-domain'</span> <span class="token punctuation">)</span><span class="token punctuation">,</span><br>        <span class="token single-quoted-string string">'render_callback'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token single-quoted-string string">'my_acf_block_render_callback'</span><span class="token punctuation">,</span><br>        <span class="token single-quoted-string string">'category'</span>        <span class="token operator">=</span><span class="token operator">></span> <span class="token single-quoted-string string">'formatting'</span><span class="token punctuation">,</span><br>        <span class="token single-quoted-string string">'icon'</span>            <span class="token operator">=</span><span class="token operator">></span> <span class="token single-quoted-string string">'admin-comments'</span><span class="token punctuation">,</span><br>        <span class="token single-quoted-string string">'keywords'</span>        <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">array</span><span class="token punctuation">(</span> <span class="token single-quoted-string string">'example'</span> <span class="token punctuation">)</span><span class="token punctuation">,</span><br>    <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>Next, you you have to create your <code>render_callback()</code> function:</p><pre class="language-php"><code class="language-php"><span class="token comment">/**<br> *  This is the callback that displays the block.<br> *<br> * @param   array  $block      The block settings and attributes.<br> * @param   string $content    The block content (emtpy string).<br> * @param   bool   $is_preview True during AJAX preview.<br> */</span><br><span class="token keyword">function</span> <span class="token function">my_acf_block_render_callback</span><span class="token punctuation">(</span> <span class="token variable">$block</span><span class="token punctuation">,</span> <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token single-quoted-string string">''</span><span class="token punctuation">,</span> <span class="token variable">$is_preview</span> <span class="token operator">=</span> <span class="token boolean constant">false</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token variable">$context</span> <span class="token operator">=</span> Timber<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Store block values.</span><br>    <span class="token variable">$context</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'block'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$block</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Store field values.</span><br>    <span class="token variable">$context</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'fields'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">get_fields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Store $is_preview value.</span><br>    <span class="token variable">$context</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'is_preview'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$is_preview</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Render the block.</span><br>    Timber<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">render</span><span class="token punctuation">(</span> <span class="token single-quoted-string string">'block/example-block.twig'</span><span class="token punctuation">,</span> <span class="token variable">$context</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>You create an extra array called <code>$context</code> with three values:</p><ul><li><strong>block</strong> - with all data like block title, alignment etc</li><li><strong>fields</strong> - all custom fields - also all the fields created in <strong>ACF</strong></li><li><strong>is_preview</strong> - returns true during AJAX preview</li></ul><p>Finally, you can create the template <strong>block/example-block.twig</strong>:</p><pre class="language-twig"><code class="language-twig"><span class="token comment">{#<br>/**<br> * Block Name: Example block<br> *<br> * This is the template that displays the example block.<br> */<br>#}</span><br><br><span class="token tag"><span class="token ld"><span class="token punctuation">{%</span> <span class="token keyword">if</span></span> <span class="token property">is_preview</span> <span class="token rd"><span class="token punctuation">%}</span></span></span><br>    <span class="token other"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>I will only appear in the editor.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></span><br><span class="token tag"><span class="token ld"><span class="token punctuation">{%</span> <span class="token keyword">endif</span></span> <span class="token rd"><span class="token punctuation">%}</span></span></span><br><br><span class="token other">&lt;div id="example-</span><span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">block</span><span class="token punctuation">.</span><span class="token property">id</span> <span class="token rd"><span class="token punctuation">}}</span></span></span><span class="token other">" class="wrapper"><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span></span><span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">fields</span><span class="token punctuation">.</span><span class="token property">title</span> <span class="token rd"><span class="token punctuation">}}</span></span></span><span class="token other"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span></span><span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">fields</span><span class="token punctuation">.</span><span class="token property">description</span> <span class="token rd"><span class="token punctuation">}}</span></span></span><span class="token other"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br>    #testimonial-</span><span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">block</span><span class="token punctuation">.</span><span class="token property">id</span> <span class="token rd"><span class="token punctuation">}}</span></span></span> <span class="token other">{<br>        background:</span> <span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">fields</span><span class="token punctuation">.</span><span class="token property">background_color</span> <span class="token rd"><span class="token punctuation">}}</span></span></span><span class="token other">;<br>        color:</span> <span class="token tag"><span class="token ld"><span class="token punctuation">{{</span></span> <span class="token property">fields</span><span class="token punctuation">.</span><span class="token property">text_color</span> <span class="token rd"><span class="token punctuation">}}</span></span></span><span class="token other">;<br>    }<br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span></span></code></pre><p>If you would like to use an external stylesheet both inside of the block editor and the frontend you should add:</p><pre class="language-php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">my_acf_block_editor_style</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token function">wp_enqueue_style</span><span class="token punctuation">(</span><br>        <span class="token single-quoted-string string">'example_block_css'</span><span class="token punctuation">,</span><br>        <span class="token function">get_template_directory_uri</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token single-quoted-string string">'/assets/example-block.css'</span><br>    <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token function">add_action</span><span class="token punctuation">(</span> <span class="token single-quoted-string string">'enqueue_block_assets'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'my_acf_block_editor_style'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>For more details about enqueueing assets read the <a href="https://wordpress.org/gutenberg/handbook/blocks/applying-styles-with-stylesheets/#enqueueing-editor-only-block-assets">Gutenberg Handbook</a>.</p><h3 id="using-repeaters">Using repeaters <a class="directLink" href="#using-repeaters">#</a></h3><pre><code>{% for field in fields.repeater %}
    Title: {{ field.title }} &lt;br/&gt;
    Url: {{ field.url }}
{% endfor %}
</code></pre><h3 id="using-groups">Using groups <a class="directLink" href="#using-groups">#</a></h3><pre><code>Title: {{ fields.group.title }} &lt;br/&gt;
Url: {{ fields.group.url }}
</code></pre>