<!doctype html><html lang="en" data-theme="dark"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-126807198-1"></script><script>window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());

	  gtag('config', 'UA-126807198-1');</script><title>Block Editor (Gutenberg) – Timber v2 – Timber Documentation</title><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="docsearch:version" content="v2"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3"><link rel="stylesheet" href="/docs/build/css/styles.css?id=c9d85857d742479204d190fd66fabaf1"><link rel="stylesheet" href="/docs/build/css/mobile.css?id=eb03f5e9c806ca82b2fc8d728401461a" media="screen and (max-width: 979px)"><script src="/docs/build/js/app.js?id=4594e1490acc2ce9d471fb2243cbcfce" defer="defer"></script><link rel="icon" href="/docs/build/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon-precomposed" sizes="57x57" href="/docs/build/favicons/apple-touch-icon-57x57.png"><link rel="apple-touch-icon-precomposed" sizes="114x114" href="/docs/build/favicons/apple-touch-icon-114x114.png"><link rel="apple-touch-icon-precomposed" sizes="72x72" href="/docs/build/favicons/apple-touch-icon-72x72.png"><link rel="apple-touch-icon-precomposed" sizes="144x144" href="/docs/build/favicons/apple-touch-icon-144x144.png"><link rel="apple-touch-icon-precomposed" sizes="60x60" href="/docs/build/favicons/apple-touch-icon-60x60.png"><link rel="apple-touch-icon-precomposed" sizes="120x120" href="/docs/build/favicons/apple-touch-icon-120x120.png"><link rel="apple-touch-icon-precomposed" sizes="76x76" href="favicons/apple-touch-icon-76x76.png"><link rel="apple-touch-icon-precomposed" sizes="152x152" href="favicons/apple-touch-icon-152x152.png"><link rel="icon" type="image/png" href="/docs/build/favicons/favicon-196x196.png" sizes="196x196"><link rel="icon" type="image/png" href="/docs/build/favicons/favicon-96x96.png" sizes="96x96"><link rel="icon" type="image/png" href="/docs/build/favicons/favicon-32x32.png" sizes="32x32"><link rel="icon" type="image/png" href="/docs/build/favicons/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="/docs/build/favicons/favicon-128.png" sizes="128x128"><meta name="application-name" content="Timber Documentation"><meta name="msapplication-TileColor" content="#FFFFFF"><meta name="msapplication-TileImage" content="/docs/build/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="/docs/build/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="/docs/build/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="/docs/build/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="/docs/build/favicons/mstile-310x310.png"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@TimberWP"><meta name="twitter:title" content="Timber for WordPress Documentation"><meta name="twitter:description" content="Create WordPress themes with beautiful OOP code and the Twig Template Engine"><meta name="twitter:image" content="https://repository-images.githubusercontent.com/7413451/06c62480-b95c-11ea-8b35-b5dd97d070f1"></head><body><header class="header"><div class="logoContainer"><a href="/docs/"><img src="/docs/build/img/timber-logo.svg" alt="Timber Logo" style="width: 105px; height: 30px; border: 0" role="img"></a></div><div class="search"><div id="docsearch"></div></div><nav class="navTop" id="nav-top"><ul><li><a href="https://upstatement.com/timber/" target="_blank" rel="noreferrer noopener">About Timber</a></li><li><a href="https://twig.symfony.com/doc/" target="_blank" rel="noreferrer noopener">Twig Docs</a></li><li><a href="https://opencollective.com/timber" target="_blank" rel="noreferrer noopener">Sponsor us</a></li><li><a href="https://github.com/timber/timber" target="_blank" rel="noreferrer noopener"><img src="/docs/build/img/github.png" alt="Star on Github" style="width: 29px; height: 29px; border: 0"></a></li></ul></nav><button class="navMobileToggle js-menu-open" type="button" id="nav-mobile-toggle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 34"><path d="M45.6,19.43H2.4a2.43,2.43,0,0,1,0-4.86H45.6a2.43,2.43,0,0,1,0,4.86Z"/><path d="M45.6,4.86H2.4A2.41,2.41,0,0,1,0,2.43,2.41,2.41,0,0,1,2.4,0H45.6A2.41,2.41,0,0,1,48,2.43,2.41,2.41,0,0,1,45.6,4.86Z"/><path d="M45.6,34H2.4a2.43,2.43,0,0,1,0-4.86H45.6a2.43,2.43,0,0,1,0,4.86Z"/></svg> <span class="sr-only">Menu</span></button></header><div class="wrapper"><aside class="sidebar slideup-menu" id="sidebar" data-turbolinks-keep-scroll-position><button class="navClose js-menu-close" type="button"><div class="navClose-icon" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="M3.43,48A3.43,3.43,0,0,1,1,42.15L42.15,1A3.43,3.43,0,1,1,47,5.85L5.85,47A3.4,3.4,0,0,1,3.43,48Z"/><path d="M44.57,48a3.4,3.4,0,0,1-2.42-1L1,5.85A3.43,3.43,0,0,1,5.85,1L47,42.15A3.43,3.43,0,0,1,44.57,48Z"/></svg></div><span class="sr-only">Close Menu</span></button><nav class="navVersions"><ul><li><a href="/docs/v2/" class="is-current">v2.x</a></li><li><a href="/docs/v1/">v1.x</a></li></ul></nav><nav id="nav-main" class="navMain"><ul class="navMain-sections"><li class="navMain-section"><h3 class="navMain-title">Installation</h3><ul class="navMain-items"><li class="navMain-item" data-order="10"><a class="navMain-link" href="/docs/v2/installation/installation/">Installation</a></li><li class="navMain-item" data-order="30"><a class="navMain-link" href="/docs/v2/installation/manage-timber-with-composer/">Managing Timber with Composer</a></li></ul></li><li class="navMain-section"><h3 class="navMain-title">Getting Started</h3><ul class="navMain-items"><li class="navMain-item" data-order="100"><a class="navMain-link" href="/docs/v2/getting-started/introduction/">Introduction</a></li><li class="navMain-item" data-order="200"><a class="navMain-link" href="/docs/v2/getting-started/template-inheritance-and-includes/">Template inheritance and includes</a></li><li class="navMain-item" data-order="300"><a class="navMain-link" href="/docs/v2/getting-started/a-single-post/">A single post</a></li><li class="navMain-item" data-order="400"><a class="navMain-link" href="/docs/v2/getting-started/a-post-archive/">A post archive</a></li></ul></li><li class="navMain-section"><h3 class="navMain-title navMain-sectionTitle">Guides</h3><ul class="navMain-items"><li class="navMain-item" data-order="50"><a class="navMain-link" href="/docs/v2/guides/context/">Context</a></li><li class="navMain-item" data-order="75"><a class="navMain-link" href="/docs/v2/guides/template-locations/">Template Locations</a></li><li class="navMain-item" data-order="110"><a class="navMain-link" href="/docs/v2/guides/posts/">Posts</a></li><li class="navMain-item" data-order="120"><a class="navMain-link" href="/docs/v2/guides/terms/">Terms</a></li><li class="navMain-item" data-order="130"><a class="navMain-link" href="/docs/v2/guides/users/">Users</a></li><li class="navMain-item" data-order="140"><a class="navMain-link" href="/docs/v2/guides/comments/">Comments</a></li><li class="navMain-item" data-order="150"><a class="navMain-link" href="/docs/v2/guides/menus/">Menus</a></li><li class="navMain-item" data-order="160"><a class="navMain-link" href="/docs/v2/guides/widgets/">Widgets</a></li><li class="navMain-item" data-order="170"><a class="navMain-link" href="/docs/v2/guides/shortcodes/">Shortcodes</a></li><li class="navMain-item" data-order="200"><a class="navMain-link" href="/docs/v2/guides/twig/">Twig</a></li><li class="navMain-item" data-order="220"><a class="navMain-link" href="/docs/v2/guides/twig-filters/">Twig filters</a></li><li class="navMain-item" data-order="300"><a class="navMain-link" href="/docs/v2/guides/cookbook-text/">Text Cookbook</a></li><li class="navMain-item" data-order="400"><a class="navMain-link" href="/docs/v2/guides/escaping/">Escaping</a></li><li class="navMain-item" data-order="500"><a class="navMain-link" href="/docs/v2/guides/custom-page-templates/">Custom Page Templates</a></li><li class="navMain-item" data-order="600"><a class="navMain-link" href="/docs/v2/guides/custom-fields/">Custom Fields</a></li><li class="navMain-item" data-order="800"><a class="navMain-link" href="/docs/v2/guides/functions/">Functions</a></li><li class="navMain-item" data-order="1000"><a class="navMain-link" href="/docs/v2/guides/cookbook-images/">Image Cookbook</a></li><li class="navMain-item" data-order="1100"><a class="navMain-link" href="/docs/v2/guides/pagination/">Pagination</a></li><li class="navMain-item" data-order="1200"><a class="navMain-link" href="/docs/v2/guides/sidebars/">Sidebars</a></li><li class="navMain-item" data-order="1300"><a class="navMain-link" href="/docs/v2/guides/performance/">Performance/Caching</a></li><li class="navMain-item" data-order="1350"><a class="navMain-link" href="/docs/v2/guides/date-time/">Date/Time in Timber</a></li><li class="navMain-item" data-order="1400"><a class="navMain-link" href="/docs/v2/guides/internationalization/">Internationalization</a></li><li class="navMain-item" data-order="1500"><a class="navMain-link" href="/docs/v2/guides/cheatsheet/">Cheatsheet</a></li><li class="navMain-item" data-order="1550"><a class="navMain-link" href="/docs/v2/guides/gutenberg/" aria-current>Block Editor (Gutenberg)</a></li><li class="navMain-item" data-order="1600"><a class="navMain-link" href="/docs/v2/guides/extending-timber/">Extending Timber</a></li><li class="navMain-item" data-order="1650"><a class="navMain-link" href="/docs/v2/guides/extending-twig/">Extending Twig</a></li><li class="navMain-item" data-order="1660"><a class="navMain-link" href="/docs/v2/guides/class-maps/">Class Maps</a></li><li class="navMain-item" data-order="1670"><a class="navMain-link" href="/docs/v2/guides/wp-cli/">WP-CLI</a></li><li class="navMain-item" data-order="1700"><a class="navMain-link" href="/docs/v2/guides/hosts-servers/">Hosts &amp; Servers</a></li><li class="navMain-item" data-order="1800"><a class="navMain-link" href="/docs/v2/guides/debugging/">Debugging</a></li><li class="navMain-item" data-order="1900"><a class="navMain-link" href="/docs/v2/guides/testing/">Automated Testing</a></li><li class="navMain-item" data-order="2000"><a class="navMain-link" href="/docs/v2/guides/routing/">Routing</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/guides/custom-integrations/">Custom Integrations</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/guides/woocommerce/">WooCommerce</a></li></ul></li><li class="navMain-section"><h3 class="navMain-title">Reference</h3><ul class="navMain-items"><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-archives/">Archives</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-attachment/">Attachment</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-cache-cleaner/">Cleaner</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-comment/">Comment</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-datetimehelper/">DateTimeHelper</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-externalimage/">ExternalImage</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-helper/">Helper</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-image/">Image</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-imagedimensions/">ImageDimensions</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-imagehelper/">ImageHelper</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-menu/">Menu</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-menuitem/">MenuItem</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-pagesmenu/">PagesMenu</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-pagination/">Pagination</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-pathhelper/">PathHelper</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-post/">Post</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-postarrayobject/">PostArrayObject</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-postexcerpt/">PostExcerpt</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-postquery/">PostQuery</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-site/">Site</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-term/">Term</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-texthelper/">TextHelper</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-theme/">Theme</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-timber/">Timber</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-urlhelper/">URLHelper</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-user/">User</a></li></ul></li><li class="navMain-section"><h3 class="navMain-title">Hooks</h3><ul class="navMain-items"><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/hooks/actions/">Action Hooks</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/hooks/filters/">Filter Hooks</a></li></ul></li><li class="navMain-section"><ul class="navMain-items"><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/integrations/advanced-custom-fields/">Advanced Custom Fields</a></li></ul></li><li class="navMain-section"><h3 class="navMain-title">Upgrade Guides</h3><ul class="navMain-items"><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/upgrade-guides/1.0/">Upgrade to 1.0</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/upgrade-guides/2.0/">Upgrade to 2.0</a></li></ul></li><li class="navMain-section"><ul class="navMain-items"><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/contributing/">Contributing to Timber</a></li></ul></li></ul></nav></aside><div class="main-container"><div class="version-note"><p>You are reading the documentation for <strong>Timber v2.x</strong>. Switch to the documentation for Timber <a href="/docs/v1/">v1.x</a>.</p></div><main><article><h1>Block Editor (Gutenberg)</h1><aside><h2 class="heading-small">On this page</h2><nav class="toc"><ol><li><a href="#using-the-block-editor-with-timber">Using the Block Editor with Timber</a></li><li><a href="#acf-blocks">ACF Blocks</a><ol><li><a href="#concept">Concept</a></li><li><a href="#prerequisites">Prerequisites</a><ol><li><a href="#add-blocks-directory-structure">Add Blocks Directory Structure</a></li><li><a href="#the-block-settings-file-block.json">The block settings file: block.json</a></li><li><a href="#register-the-block">Register the Block</a></li><li><a href="#render-block">Render block</a></li><li><a href="#create-fields-in-acf">Create fields in ACF</a></li><li><a href="#block-template">Block Template</a></li></ol></li></ol></li></ol></nav></aside><div class="content"><h2 id="using-the-block-editor-with-timber" tabindex="-1">Using the Block Editor with Timber <a class="directLink" href="#using-the-block-editor-with-timber">#</a></h2><p>Timber works with the Block Editor (also called Gutenberg) out of the box. If you use <code>{{ post.content }}</code>, Timber will render all the Gutenberg blocks.</p><h2 id="acf-blocks" tabindex="-1">ACF Blocks <a class="directLink" href="#acf-blocks">#</a></h2><p><a href="https://www.advancedcustomfields.com/resources/blocks/">ACF Blocks</a> are an alternative way to create content blocks without advanced JavaScript knowledge.</p><h3 id="concept" tabindex="-1">Concept <a class="directLink" href="#concept">#</a></h3><p>A (ACF) block is an individual element that can be added to a page or post. It can be a simple text block, a gallery, a call to action, or a complex layout. Blocks are the building blocks of your website. In this tutorial, we will show you how to create a simple block with ACF and Timber.</p><h3 id="prerequisites" tabindex="-1">Prerequisites <a class="directLink" href="#prerequisites">#</a></h3><p>Before you can start using ACF Blocks, you must install Advanced Custom Fields Pro 6.0 or later.</p><h4 id="add-blocks-directory-structure" tabindex="-1">Add Blocks Directory Structure <a class="directLink" href="#add-blocks-directory-structure">#</a></h4><p>First, we will create a <code>blocks</code> directory in our theme folder. This directory will house folders for each of our custom blocks. Inside each block directory, we will have a block.json file, a CSS file and a Twig template.</p><ol><li>Create a <code>blocks</code> directory in the root of your theme.</li><li>Add a directory with the block name of your choice. Example: <strong>my-block</strong>.</li><li>Within your custom block directory, create a block.json file.</li><li>Also within your custom block directory, add a CSS file to reference in the settings.<ul><li>Note: this is optional. You can reference CSS from any directory or rely on sitewide styling to get applied to your block on production.</li></ul></li></ol><p>Your theme structure should look like this:</p><pre><code>|--...
|-- wp-content
|   |-- themes
|       |-- your-theme                  # Your theme directory
|           |-- blocks                  # Your blocks directory
|               |-- my-block            # Your block
|                   |-- block.json      # Your block settings
|                   |-- my-block.css    # Styles for your block
|                   |-- my-block.twig   # Your block template
</code></pre><h4 id="the-block-settings-file-block.json" tabindex="-1">The block settings file: block.json <a class="directLink" href="#the-block-settings-file-block.json">#</a></h4><p>The block.json file is a configuration file that contains the settings for your block. It is used to define the block’s name, title, description, category among many other settings.</p><p><a href="https://developer.wordpress.org/block-editor/reference-guides/block-api/block-metadata/">WordPress has a full example</a> of the values you can add to your block.json. For our example, we’ll follow <a href="https://www.advancedcustomfields.com/resources/acf-blocks-key-concepts/#acf-blocks-and-blockjson">ACF's example</a> with the minimal settings plus the specific ACF property. We will use <code>renderCallback</code> instead of <code>renderTemplate</code> so we can set a function callback to render all our blocks instead of creating a function for each individual block.</p><p>Example contents of the block.json</p><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span><br>    <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"acf/my-block"</span><span class="token punctuation">,</span><br>    <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"My Block"</span><span class="token punctuation">,</span><br>    <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Description for my block"</span><span class="token punctuation">,</span><br>    <span class="token property">"style"</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">"file:./my-block.css"</span> <span class="token punctuation">]</span><span class="token punctuation">,</span><br>    <span class="token property">"category"</span><span class="token operator">:</span> <span class="token string">"formatting"</span><span class="token punctuation">,</span><br>    <span class="token property">"icon"</span><span class="token operator">:</span> <span class="token string">"format-aside"</span><span class="token punctuation">,</span><br>    <span class="token property">"keywords"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"my"</span><span class="token punctuation">,</span> <span class="token string">"block"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>    <span class="token property">"acf"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>        <span class="token property">"mode"</span><span class="token operator">:</span> <span class="token string">"preview"</span><span class="token punctuation">,</span><br>        <span class="token property">"renderCallback"</span><span class="token operator">:</span> <span class="token string">"my_acf_block_render_callback"</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p><strong>Notes:</strong></p><ul><li>Learn more about the different entries in the block.json file in the <a href="https://developer.wordpress.org/block-editor/reference-guides/block-api/block-metadata">WordPress documentation</a>.</li><li>For the entries under <code>acf</code>, learn more in the <a href="https://www.advancedcustomfields.com/resources/acf-blocks-key-concepts/#acf-blocks-and-blockjson">ACF documentation</a>.</li><li>For the <code>name</code> property, you are not required to use <code>acf</code> as the namespace in the naming convention <code>namespace/block-name</code>, but you do have to provide one. For example: you could also name them <code>my-project/block-name</code>. We recommend using the same namespace throughout your blocks and that, in the case you use another namespace then <code>acf</code>, you need to change the render callback as well to omit your chosen namespace.</li></ul><h4 id="register-the-block" tabindex="-1">Register the Block <a class="directLink" href="#register-the-block">#</a></h4><p>Your theme needs to know the block exists on <code>init</code> so we will use the <a href="https://developer.wordpress.org/reference/functions/register_block_type/">register_block_type()</a> function and trigger the function on the <code>init</code> action.</p><p>Here’s the straight-forward way to do this.</p><p><strong>functions.php</strong></p><pre class="language-php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">register_acf_blocks</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token comment">// The register_block_type() function will look in the current directory and</span><br>    <span class="token comment">// register the block you specify. Add additional register_block_type()</span><br>    <span class="token comment">// functions for each of your custom blocks.</span><br>    <span class="token function">register_block_type</span><span class="token punctuation">(</span> <span class="token constant">__DIR__</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/blocks/my-block'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token function">add_action</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'init'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'register_acf_blocks'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Alternatively, you can dynamically register each block. This will keep our code DRY and prevent you from having to register each individual block every time you create a new one.</p><pre class="language-php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">register_acf_blocks</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$blocks</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DirectoryIterator</span><span class="token punctuation">(</span> <span class="token constant">__DIR__</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/blocks'</span> <span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token variable">$item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token comment">// Check if block.json file exists in each subfolder.</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$item</span><span class="token operator">-></span><span class="token function">isDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token variable">$item</span><span class="token operator">-></span><span class="token function">isDot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>            <span class="token operator">&amp;&amp;</span> <span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token variable">$item</span><span class="token operator">-></span><span class="token function">getPathname</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/block.json'</span><span class="token punctuation">)</span><br>        <span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token comment">// Register the block given the directory name within the blocks</span><br>            <span class="token comment">// directory.</span><br>            <span class="token function">register_block_type</span><span class="token punctuation">(</span><span class="token variable">$item</span> <span class="token operator">-></span> <span class="token function">getPathname</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token function">add_action</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'init'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'register_acf_blocks'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h4 id="render-block" tabindex="-1">Render block <a class="directLink" href="#render-block">#</a></h4><p>Now that we have our block registered, we need to create a function to render our blocks. We will create a function called <code>my_acf_block_render_callback()</code> that will be used to render all our blocks. In this function, we will prepare the context for our block and render the block using Timber.</p><pre class="language-php"><code class="language-php"><span class="token comment">/**<br> * Render callback to prepare and display a registered block using Timber.<br> *<br> * @param    array    $attributes The block attributes.<br> * @param    string   $content The block content.<br> * @param    bool     $is_preview Whether or not the block is being rendered for editing preview.<br> * @param    int      $post_id The current post being edited or viewed.<br> * @param    WP_Block $wp_block The block instance (since WP 5.5).<br> * @return   void<br> */</span><br><span class="token keyword">function</span> <span class="token function-definition function">my_acf_block_render_callback</span><span class="token punctuation">(</span><span class="token variable">$attributes</span><span class="token punctuation">,</span> <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$is_preview</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">,</span> <span class="token variable">$post_id</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token variable">$wp_block</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token comment">// Create the slug of the block using the name property in the block.json.</span><br>    <span class="token variable">$slug</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'acf/'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$block</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token variable">$context</span> <span class="token operator">=</span> <span class="token class-name static-context">Timber</span><span class="token operator">::</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Store block attributes.</span><br>    <span class="token variable">$context</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'attributes'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$attributes</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Store field values. These are the fields from your ACF field group for the block.</span><br>    <span class="token variable">$context</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fields'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">get_fields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Store whether the block is being rendered in the editor or on the frontend.</span><br>    <span class="token variable">$context</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'is_preview'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$is_preview</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// Render the block.</span><br>    <span class="token class-name static-context">Timber</span><span class="token operator">::</span><span class="token function">render</span><span class="token punctuation">(</span><br>        <span class="token string single-quoted-string">'blocks/'</span> <span class="token operator">.</span> <span class="token variable">$slug</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/'</span> <span class="token operator">.</span> <span class="token variable">$slug</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'.twig'</span><span class="token punctuation">,</span><br>        <span class="token variable">$context</span><br>    <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>We call this function in the <code>renderCallback</code> object in the block.json file of our block. This function will work for all blocks as long as we follow the naming convention of <code>acf/your-block-name</code> for the name property in the block.json and name the template <code>your-block-name.twig</code> in the blocks folder inside the views directory.</p><h4 id="create-fields-in-acf" tabindex="-1">Create fields in ACF <a class="directLink" href="#create-fields-in-acf">#</a></h4><p><a href="https://www.advancedcustomfields.com/resources/create-your-first-acf-block/#create-the-testimonial-field-group">ACF has precise guidance</a> on how to create the fields for your block. The important thing is to make sure the field group is enabled for your specific block:</p><ul><li><strong>Show field group if:</strong> Block</li><li><strong>Operator:</strong> is equal to</li><li><strong>Selector:</strong> My Block</li></ul><h4 id="block-template" tabindex="-1">Block Template <a class="directLink" href="#block-template">#</a></h4><p>Now that we have our block directory and settings, we need the a Twig template for our block that will be used to display our block.</p><p>Within our new Twig template, we will call each of the fields we created in ACF for our block. Each field we define for this block in ACF will be prepended with the fields key. Here is a simple example:</p><p><strong>my-block.twig</strong></p><pre class="language-twig"><code class="language-twig"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span><span class="token twig language-twig"><span class="token delimiter punctuation">{{</span> fields<span class="token punctuation">.</span>title <span class="token delimiter punctuation">}}</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token twig language-twig"><span class="token delimiter punctuation">{{</span> fields<span class="token punctuation">.</span>text <span class="token delimiter punctuation">}}</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre><h5>Using repeaters</h5><pre class="language-twig"><code class="language-twig"><span class="token twig language-twig"><span class="token delimiter punctuation">{%</span> <span class="token tag-name keyword">for</span> field <span class="token operator">in</span> fields<span class="token punctuation">.</span>repeater <span class="token delimiter punctuation">%}</span></span><br>    Title: <span class="token twig language-twig"><span class="token delimiter punctuation">{{</span> field<span class="token punctuation">.</span>title <span class="token delimiter punctuation">}}</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/></span></span><br>    Url: <span class="token twig language-twig"><span class="token delimiter punctuation">{{</span> field<span class="token punctuation">.</span>url <span class="token delimiter punctuation">}}</span></span><br><span class="token twig language-twig"><span class="token delimiter punctuation">{%</span> <span class="token tag-name keyword">endfor</span> <span class="token delimiter punctuation">%}</span></span></code></pre><h5>Using groups</h5><pre class="language-twig"><code class="language-twig">Title: <span class="token twig language-twig"><span class="token delimiter punctuation">{{</span> fields<span class="token punctuation">.</span>group<span class="token punctuation">.</span>title <span class="token delimiter punctuation">}}</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/></span></span><br>Url: <span class="token twig language-twig"><span class="token delimiter punctuation">{{</span> fields<span class="token punctuation">.</span>group<span class="token punctuation">.</span>url <span class="token delimiter punctuation">}}</span></span></code></pre></div></article></main></div></div><script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script><script>docsearch({
    appId: '7REN4GR6X4',
    apiKey: '9acbf22ef9a9b117a0f9ba50bd2f4280',
    /**
     * Timber config.
     *
     * @link https://github.com/algolia/docsearch-configs/blob/master/configs/timber.json
     */
    indexName: 'timber',
    container: '#docsearch',
    /**
     * Filter for different doc versions.
     *
     * @link https://www.algolia.com/doc/api-reference/api-parameters/facetFilters/
     */
    searchParameters: {
      facetFilters: ['version:v2']
    },
    // Set debug to true if you want to inspect the dropdown.
    // debug: true
  })</script></body></html>