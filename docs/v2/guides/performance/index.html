<!doctype html><html lang="en" data-theme="dark"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-126807198-1"></script><script>window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());

	  gtag('config', 'UA-126807198-1');</script><title>Performance/Caching – Timber v2 – Timber Documentation</title><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="docsearch:version" content="v2"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3"><link rel="stylesheet" href="/docs/build/css/styles.css?id=ca7f85fab34b0835f0eda46e1f2a8b4f"><link rel="stylesheet" href="/docs/build/css/mobile.css?id=6d8ba2c03ef755b0b10457946f11ebe0" media="screen and (max-width: 979px)"><script src="/docs/build/js/app.js?id=844725d01ccc3115ce817a37e99c97d2" defer="defer"></script><link rel="icon" href="/docs/build/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon-precomposed" sizes="57x57" href="/docs/build/favicons/apple-touch-icon-57x57.png"><link rel="apple-touch-icon-precomposed" sizes="114x114" href="/docs/build/favicons/apple-touch-icon-114x114.png"><link rel="apple-touch-icon-precomposed" sizes="72x72" href="/docs/build/favicons/apple-touch-icon-72x72.png"><link rel="apple-touch-icon-precomposed" sizes="144x144" href="/docs/build/favicons/apple-touch-icon-144x144.png"><link rel="apple-touch-icon-precomposed" sizes="60x60" href="/docs/build/favicons/apple-touch-icon-60x60.png"><link rel="apple-touch-icon-precomposed" sizes="120x120" href="/docs/build/favicons/apple-touch-icon-120x120.png"><link rel="apple-touch-icon-precomposed" sizes="76x76" href="favicons/apple-touch-icon-76x76.png"><link rel="apple-touch-icon-precomposed" sizes="152x152" href="favicons/apple-touch-icon-152x152.png"><link rel="icon" type="image/png" href="/docs/build/favicons/favicon-196x196.png" sizes="196x196"><link rel="icon" type="image/png" href="/docs/build/favicons/favicon-96x96.png" sizes="96x96"><link rel="icon" type="image/png" href="/docs/build/favicons/favicon-32x32.png" sizes="32x32"><link rel="icon" type="image/png" href="/docs/build/favicons/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="/docs/build/favicons/favicon-128.png" sizes="128x128"><meta name="application-name" content="Timber Documentation"><meta name="msapplication-TileColor" content="#FFFFFF"><meta name="msapplication-TileImage" content="/docs/build/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="/docs/build/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="/docs/build/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="/docs/build/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="/docs/build/favicons/mstile-310x310.png"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@TimberWP"><meta name="twitter:title" content="Timber for WordPress Documentation"><meta name="twitter:description" content="Create WordPress themes with beautiful OOP code and the Twig Template Engine"><meta name="twitter:image" content="https://repository-images.githubusercontent.com/7413451/06c62480-b95c-11ea-8b35-b5dd97d070f1"></head><body><header class="header"><div class="logoContainer"><a href="/docs/"><svg aria-hidden="true" focusable="false" class="logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 104.45 30"><title>Logo Tiny White</title><path class="text" d="M32.41,13.27H28.73V10H39.88v3.26h-3.7v13H32.41Z"/><path class="text" d="M44.28,9.1A2.26,2.26,0,1,1,42,11.36,2.26,2.26,0,0,1,44.28,9.1Zm-1.77,6h3.56V26.3H42.51Z"/><path class="text" d="M62.61,26.3V20.25c0-1.51-.51-2.42-1.72-2.42S59,18.51,59,20.67V26.3H55.55V20.23c0-1.51-.49-2.4-1.68-2.4s-1.93.7-1.93,2.91V26.3H48.5V15.09h3.44v1.63a3.51,3.51,0,0,1,3.24-1.91,3.28,3.28,0,0,1,3.4,2,3.83,3.83,0,0,1,3.51-2C65.35,14.81,66,17,66,19.39V26.3Z"/><path class="text" d="M72,26.3H68.45V10H72v6.68a4.06,4.06,0,0,1,3.44-1.89c3.24,0,5.47,2.54,5.47,5.89s-2.23,5.89-5.47,5.89A4,4,0,0,1,72,24.72Zm5.35-5.61a2.68,2.68,0,1,0-5.35,0,2.68,2.68,0,1,0,5.35,0Z"/><path class="text" d="M86.31,21.56c.07,1.35.63,2.49,2.49,2.49a1.92,1.92,0,0,0,2.07-1.28h3.49C94,24.88,92,26.61,88.82,26.61c-3.93,0-6.05-2.44-6.05-5.91a5.58,5.58,0,0,1,6-5.91c3.51,0,5.77,2.37,5.77,5.12a9,9,0,0,1-.12,1.65Zm0-2H91a2.35,2.35,0,0,0-4.7,0Z"/><path class="text" d="M104.45,18.32a4.67,4.67,0,0,0-1.26-.16c-2,0-3.24,1-3.24,3.77V26.3H96.4V15.09H100V16.9a3.91,3.91,0,0,1,3.42-2,2.52,2.52,0,0,1,1.07.19Z"/><polygon class="shape" points="24.65 26.39 23.09 24.39 14.12 24.39 14.12 22.24 21.42 22.24 19.87 20.24 14.12 20.24 14.12 18.09 21.73 18.09 20.29 16.09 14.12 16.09 14.12 13.94 18.75 13.94 17.31 11.94 14.12 11.94 14.12 9.79 18.5 9.79 17.09 7.79 14.12 7.79 14.12 5.64 15.57 5.64 14.16 3.64 14.12 3.64 14.12 0 7.54 9.17 11.24 9.18 3.77 19.59 7.62 19.59 0 30 14.12 30 14.12 26.39 24.65 26.39"/></svg> <span class="sr-only">Timber</span></a></div><div class="search"><div id="docsearch"></div></div><nav class="navTop" id="nav-top"><ul><li><a href="https://upstatement.com/timber/" target="_blank" rel="noreferrer noopener">About Timber</a></li><li><a href="https://twig.symfony.com/doc/" target="_blank" rel="noreferrer noopener">Twig Docs</a></li><li><a href="https://opencollective.com/timber" target="_blank" rel="noreferrer noopener">Sponsor us</a></li><li><a class="nav-link" href="https://github.com/timber/timber" target="_blank" rel="noreferrer noopener"><span class="sr-only">Star on Github</span> <svg viewBox="0 0 98 96" aria-hidden="true" focusable="false"><path fill="currentColor" fill-rule="evenodd" d="M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z" clip-rule="evenodd"></path></svg></a></li></ul></nav><button class="themeSwitcher" type="button" onclick="window.switchTheme()"><span class="themeSwitcher__indicator themeSwitcher__indicator--dark"><svg aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg> </span><span class="themeSwitcher__indicator themeSwitcher__indicator--light"><svg aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-moon"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></svg> </span><span class="sr-only">Toggle Light Dark Mode</span></button> <button class="navMobileToggle js-menu-open" type="button" id="nav-mobile-toggle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 34"><path d="M45.6,19.43H2.4a2.43,2.43,0,0,1,0-4.86H45.6a2.43,2.43,0,0,1,0,4.86Z"/><path d="M45.6,4.86H2.4A2.41,2.41,0,0,1,0,2.43,2.41,2.41,0,0,1,2.4,0H45.6A2.41,2.41,0,0,1,48,2.43,2.41,2.41,0,0,1,45.6,4.86Z"/><path d="M45.6,34H2.4a2.43,2.43,0,0,1,0-4.86H45.6a2.43,2.43,0,0,1,0,4.86Z"/></svg> <span class="sr-only">Menu</span></button></header><div class="wrapper"><aside class="sidebar slideup-menu" id="sidebar" data-turbolinks-keep-scroll-position><button class="navClose js-menu-close" type="button"><div class="navClose-icon" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="M3.43,48A3.43,3.43,0,0,1,1,42.15L42.15,1A3.43,3.43,0,1,1,47,5.85L5.85,47A3.4,3.4,0,0,1,3.43,48Z"/><path d="M44.57,48a3.4,3.4,0,0,1-2.42-1L1,5.85A3.43,3.43,0,0,1,5.85,1L47,42.15A3.43,3.43,0,0,1,44.57,48Z"/></svg></div><span class="sr-only">Close Menu</span></button><nav class="navVersions"><ul><li><a href="/docs/v2/" class="is-current">v2.x</a></li><li><a href="/docs/v1/">v1.x</a></li></ul></nav><nav id="nav-main" class="navMain"><ul class="navMain-sections"><li class="navMain-section"><h3 class="navMain-title">Installation</h3><ul class="navMain-items"><li class="navMain-item" data-order="10"><a class="navMain-link" href="/docs/v2/installation/installation/">Installation</a></li><li class="navMain-item" data-order="30"><a class="navMain-link" href="/docs/v2/installation/manage-timber-with-composer/">Managing Timber with Composer</a></li></ul></li><li class="navMain-section"><h3 class="navMain-title">Getting Started</h3><ul class="navMain-items"><li class="navMain-item" data-order="100"><a class="navMain-link" href="/docs/v2/getting-started/introduction/">Introduction</a></li><li class="navMain-item" data-order="200"><a class="navMain-link" href="/docs/v2/getting-started/template-inheritance-and-includes/">Template inheritance and includes</a></li><li class="navMain-item" data-order="300"><a class="navMain-link" href="/docs/v2/getting-started/a-single-post/">A single post</a></li><li class="navMain-item" data-order="400"><a class="navMain-link" href="/docs/v2/getting-started/a-post-archive/">A post archive</a></li></ul></li><li class="navMain-section"><h3 class="navMain-title navMain-sectionTitle">Guides</h3><ul class="navMain-items"><li class="navMain-item" data-order="50"><a class="navMain-link" href="/docs/v2/guides/context/">Context</a></li><li class="navMain-item" data-order="75"><a class="navMain-link" href="/docs/v2/guides/template-locations/">Template Locations</a></li><li class="navMain-item" data-order="110"><a class="navMain-link" href="/docs/v2/guides/posts/">Posts</a></li><li class="navMain-item" data-order="120"><a class="navMain-link" href="/docs/v2/guides/terms/">Terms</a></li><li class="navMain-item" data-order="130"><a class="navMain-link" href="/docs/v2/guides/users/">Users</a></li><li class="navMain-item" data-order="140"><a class="navMain-link" href="/docs/v2/guides/comments/">Comments</a></li><li class="navMain-item" data-order="150"><a class="navMain-link" href="/docs/v2/guides/menus/">Menus</a></li><li class="navMain-item" data-order="160"><a class="navMain-link" href="/docs/v2/guides/widgets/">Widgets</a></li><li class="navMain-item" data-order="170"><a class="navMain-link" href="/docs/v2/guides/shortcodes/">Shortcodes</a></li><li class="navMain-item" data-order="200"><a class="navMain-link" href="/docs/v2/guides/twig/">Twig</a></li><li class="navMain-item" data-order="220"><a class="navMain-link" href="/docs/v2/guides/twig-filters/">Twig filters</a></li><li class="navMain-item" data-order="300"><a class="navMain-link" href="/docs/v2/guides/cookbook-text/">Text Cookbook</a></li><li class="navMain-item" data-order="400"><a class="navMain-link" href="/docs/v2/guides/escaping/">Escaping</a></li><li class="navMain-item" data-order="500"><a class="navMain-link" href="/docs/v2/guides/custom-page-templates/">Custom Page Templates</a></li><li class="navMain-item" data-order="600"><a class="navMain-link" href="/docs/v2/guides/custom-fields/">Custom Fields</a></li><li class="navMain-item" data-order="800"><a class="navMain-link" href="/docs/v2/guides/functions/">Functions</a></li><li class="navMain-item" data-order="1000"><a class="navMain-link" href="/docs/v2/guides/cookbook-images/">Image Cookbook</a></li><li class="navMain-item" data-order="1100"><a class="navMain-link" href="/docs/v2/guides/pagination/">Pagination</a></li><li class="navMain-item" data-order="1200"><a class="navMain-link" href="/docs/v2/guides/sidebars/">Sidebars</a></li><li class="navMain-item" data-order="1300"><a class="navMain-link" href="/docs/v2/guides/performance/" aria-current>Performance/Caching</a></li><li class="navMain-item" data-order="1350"><a class="navMain-link" href="/docs/v2/guides/date-time/">Date/Time in Timber</a></li><li class="navMain-item" data-order="1400"><a class="navMain-link" href="/docs/v2/guides/internationalization/">Internationalization</a></li><li class="navMain-item" data-order="1500"><a class="navMain-link" href="/docs/v2/guides/cheatsheet/">Cheatsheet</a></li><li class="navMain-item" data-order="1550"><a class="navMain-link" href="/docs/v2/guides/gutenberg/">Block Editor (Gutenberg)</a></li><li class="navMain-item" data-order="1600"><a class="navMain-link" href="/docs/v2/guides/extending-timber/">Extending Timber</a></li><li class="navMain-item" data-order="1650"><a class="navMain-link" href="/docs/v2/guides/extending-twig/">Extending Twig</a></li><li class="navMain-item" data-order="1660"><a class="navMain-link" href="/docs/v2/guides/class-maps/">Class Maps</a></li><li class="navMain-item" data-order="1670"><a class="navMain-link" href="/docs/v2/guides/wp-cli/">WP-CLI</a></li><li class="navMain-item" data-order="1700"><a class="navMain-link" href="/docs/v2/guides/hosts-servers/">Hosts &amp; Servers</a></li><li class="navMain-item" data-order="1800"><a class="navMain-link" href="/docs/v2/guides/debugging/">Debugging</a></li><li class="navMain-item" data-order="1900"><a class="navMain-link" href="/docs/v2/guides/testing/">Automated Testing</a></li><li class="navMain-item" data-order="2000"><a class="navMain-link" href="/docs/v2/guides/routing/">Routing</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/guides/custom-integrations/">Custom Integrations</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/guides/woocommerce/">WooCommerce</a></li></ul></li><li class="navMain-section"><h3 class="navMain-title">Reference</h3><ul class="navMain-items"><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-archives/">Archives</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-attachment/">Attachment</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-cache-cleaner/">Cleaner</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-comment/">Comment</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-datetimehelper/">DateTimeHelper</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-externalimage/">ExternalImage</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-helper/">Helper</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-image/">Image</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-imagedimensions/">ImageDimensions</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-imagehelper/">ImageHelper</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-menu/">Menu</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-menuitem/">MenuItem</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-pagesmenu/">PagesMenu</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-pagination/">Pagination</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-pathhelper/">PathHelper</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-post/">Post</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-postarrayobject/">PostArrayObject</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-postexcerpt/">PostExcerpt</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-postquery/">PostQuery</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-site/">Site</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-term/">Term</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-texthelper/">TextHelper</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-theme/">Theme</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-timber/">Timber</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-urlhelper/">URLHelper</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/reference/timber-user/">User</a></li></ul></li><li class="navMain-section"><h3 class="navMain-title">Hooks</h3><ul class="navMain-items"><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/hooks/actions/">Action Hooks</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/hooks/filters/">Filter Hooks</a></li></ul></li><li class="navMain-section"><ul class="navMain-items"><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/integrations/advanced-custom-fields/">Advanced Custom Fields</a></li></ul></li><li class="navMain-section"><h3 class="navMain-title">Upgrade Guides</h3><ul class="navMain-items"><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/upgrade-guides/1.0/">Upgrade to 1.0</a></li><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/upgrade-guides/2.0/">Upgrade to 2.0</a></li></ul></li><li class="navMain-section"><ul class="navMain-items"><li class="navMain-item" data-order=""><a class="navMain-link" href="/docs/v2/contributing/">Contributing to Timber</a></li></ul></li></ul></nav></aside><div class="main-container"><div class="version-note"><p>You are reading the documentation for <strong>Timber v2.x</strong>. Switch to the documentation for Timber <a href="/docs/v1/">v1.x</a>.</p></div><main><article><h1>Performance/Caching</h1><aside><h2 class="heading-small">On this page</h2><nav class="toc"><ol><li><a href="#tl;dr">tl;dr</a></li><li><a href="#cache-everything">Cache Everything</a></li><li><a href="#cache-the-entire-twig-file-and-data">Cache the Entire Twig File and Data</a><ol><li><a href="#timber-cache-modes">Timber cache modes</a><ol><li><a href="#set-timber-cache-mode-globally">Set Timber cache mode globally</a></li><li><a href="#set-timber-cache-mode-per-compile-or-render-method">Set Timber cache mode per compile or render method</a></li></ol></li></ol></li><li><a href="#cache-the-twig-file-but-not-the-data">Cache the Twig File (but not the data)</a></li><li><a href="#cache-parts-of-the-twig-file-and-data">Cache Parts of the Twig File and Data</a><ol><li><a href="#extra-timberkeygeneratorinterface">Extra: TimberKeyGeneratorInterface</a></li></ol></li><li><a href="#cache-the-php-data">Cache the PHP data</a></li><li><a href="#measuring-performance">Measuring Performance</a></li><li><a href="#important-notes">Important notes</a></li></ol></nav></aside><div class="content"><p>Timber, especially in conjunction with WordPress and Twig, offers a variety of caching strategies to optimize performance. Here’s a quick rundown of some of the options, ranked in order of most-broad to most-focused.</p><h2 id="tl;dr" tabindex="-1">tl;dr <a class="directLink" href="#tl;dr">#</a></h2><p>In my tests with Debug Bar, Timber has no measurable performance hit. Everything compiles to PHP. @fabpot has an <a href="https://fabien.potencier.org/article/34/templating-engines-in-php">overview of the performance costs on his blog</a> (scroll down to the table).</p><h2 id="cache-everything" tabindex="-1">Cache Everything <a class="directLink" href="#cache-everything">#</a></h2><p>You can still use plugins like <a href="https://wordpress.org/plugins/w3-total-cache/">W3 Total Cache</a> in conjunction with Timber. In most settings, this will <em>skip</em> the Twig/Timber layer of your files and serve static pages via whatever mechanism the plugin or settings dictate.</p><h2 id="cache-the-entire-twig-file-and-data" tabindex="-1">Cache the Entire Twig File and Data <a class="directLink" href="#cache-the-entire-twig-file-and-data">#</a></h2><p>With Timber you can cache the full Timber render/compile calls. When you do this, the whole template you render and its data will be cached. This results in faster page rendering by skipping queries and Twig compilations. But here’s the cool part: Timber hashes the fields in the view context. This means that <strong>as soon as the data changes, the cache is automatically invalidated</strong>. Yay!</p><p>For Timber caching to take effect on your <code>Timber::render()</code> and <code>Timber::compile()</code> calls, you need to set the <code>$expires</code> argument. If the <code>$expires</code> argument is not set, Timber will not cache that particular template, even if the (global)cache mode is set.</p><p>Example:</p><pre class="language-php"><code class="language-php"><span class="token variable">$context</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'posts'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name static-context">Timber</span><span class="token operator">::</span><span class="token function">get_posts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token class-name static-context">Timber</span><span class="token operator">::</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'index.twig'</span><span class="token punctuation">,</span> <span class="token variable">$context</span><span class="token punctuation">,</span> <span class="token number">600</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>In this example, Timber will cache the template for 10 minutes (600 / 60 = 10) with the default cache mode which is &quot;transient&quot;. You can change the cache mode for Timber globally or on a per method basis. See <a href="#timber-cache-modes">Timber cache modes</a> for more information.</p><p>This caching method is very effective, but crude - the whole template is cached. So if you have any context dependent sub-views (eg. current user), this mode won’t do.</p><h3 id="timber-cache-modes" tabindex="-1">Timber cache modes <a class="directLink" href="#timber-cache-modes">#</a></h3><p>Timber has 5 cache modes that it can use for the Timber <code>Timber::render()</code> and <code>Timber::compile()</code> methods. The following cache modes are available:</p><table><thead><tr><th>Mode</th><th>Description</th></tr></thead><tbody><tr><td><code>Timber\Loader::CACHE_NONE</code></td><td>Disable caching</td></tr><tr><td><code>Timber\Loader::CACHE_OBJECT</code></td><td>WP Object Cache</td></tr><tr><td><code>Timber\Loader::CACHE_TRANSIENT</code></td><td>Transients</td></tr><tr><td><code>Timber\Loader::CACHE_SITE_TRANSIENT</code></td><td>Network wide transients</td></tr><tr><td><code>Timber\Loader::CACHE_USE_DEFAULT</code></td><td>Use whatever caching mechanism is set as the default for <code>Timber\Loader</code>, the default is <code>CACHE_TRANSIENT</code>.</td></tr></tbody></table><p>By default the cache mode is set to transients. You can change the default cache mode globally by using a filter or on a per method basis. We will go over them both.</p><h4 id="set-timber-cache-mode-globally" tabindex="-1">Set Timber cache mode globally <a class="directLink" href="#set-timber-cache-mode-globally">#</a></h4><p>The default cache mode can be changed by using the <code>timber/cache/mode</code> filter. For example:</p><pre class="language-php"><code class="language-php"><span class="token function">apply_filters</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'timber/cache/mode'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> <span class="token class-name class-name-fully-qualified static-context">Timber<span class="token punctuation">\</span>Loader</span><span class="token operator">::</span><span class="token constant">CACHE_OBJECT</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Sets the global/default cache mode to <code>CACHE_OBJECT</code>.</p><h4 id="set-timber-cache-mode-per-compile-or-render-method" tabindex="-1">Set Timber cache mode per compile or render method <a class="directLink" href="#set-timber-cache-mode-per-compile-or-render-method">#</a></h4><p>As a fourth parameter for <a href="https://timber.github.io/docs/v2/reference/timber-timber/#render">Timber::render()</a> and <a href="https://timber.github.io/docs/v2/reference/timber-timber/#compile">Timber::compile()</a>, you can set the <code>$cache_mode</code>.</p><p>For example:</p><pre class="language-php"><code class="language-php"><span class="token class-name static-context">Timber</span><span class="token operator">::</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token variable">$filenames</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token number">600</span><span class="token punctuation">,</span> <span class="token class-name class-name-fully-qualified static-context">Timber<span class="token punctuation">\</span>Loader</span><span class="token operator">::</span><span class="token constant">CACHE_OBJECT</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2 id="cache-the-twig-file-but-not-the-data" tabindex="-1">Cache the Twig File (but not the data) <a class="directLink" href="#cache-the-twig-file-but-not-the-data">#</a></h2><p>Every time you render a <code>.twig</code> file, Twig compiles all the HTML tags and variables into a big, nasty blob of function calls and echo statements that actually gets run by PHP. In general, this is pretty efficient. However, you can cache the resulting PHP blob by turning on Twig’s cache via:</p><p><strong>functions.php</strong></p><pre class="language-php"><code class="language-php"><span class="token function">add_filter</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'timber/twig/environment/options'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token variable">$options</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cache'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">return</span> <span class="token variable">$options</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>You can look in your your <code>/vendor/timber/timber/cache</code> directory to see what these files look like.</p><p>If you want to change the path where Timber caches the Twig files, you can pass in an absolute path for the <code>cache</code> option:</p><pre class="language-php"><code class="language-php"><span class="token function">add_filter</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'timber/twig/environment/options'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token variable">$options</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cache'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'/absolute/path/to/twig_cache'</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">return</span> <span class="token variable">$options</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>This does not cache the <em>contents</em> of the variables. But rather, the structure of the Twig files themselves (i.e. the HTML and where those variables appear in your template). Once enabled, any change you make to a <code>.twig</code> file (just tweaking the HTML for example) will not go live until the cache is flushed.</p><p>Thus, during development, you should enable the option for <code>auto_reload</code>:</p><pre class="language-php"><code class="language-php"><span class="token function">add_filter</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'timber/twig/environment/options'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token variable">$options</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cache'</span><span class="token punctuation">]</span>       <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span><br>    <span class="token variable">$options</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'auto_reload'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">return</span> <span class="token variable">$options</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Enabling <code>Timber::$cache</code> works best as a last step in the production process. Once enabled, any change you make to a <code>.twig</code> file (just tweaking the HTML for example) will not go live until the cache is flushed.</p><p>Note that when <code>WP_DEBUG</code> is set to <code>true</code>, changes you make to <code>.twig</code> files will be reflected on the site regardless of the <code>Timber::$cache</code> value.</p><p>To flush the Twig cache you can do this:</p><pre class="language-php"><code class="language-php"><span class="token variable">$loader</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">Timber<span class="token punctuation">\</span>Loader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token variable">$loader</span><span class="token operator">-></span><span class="token function">clear_cache_twig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2 id="cache-parts-of-the-twig-file-and-data" tabindex="-1">Cache <em>Parts</em> of the Twig File and Data <a class="directLink" href="#cache-parts-of-the-twig-file-and-data">#</a></h2><p>If you want to use <a href="https://twig.symfony.com/doc/3.x/tags/cache.html"><code>cache</code> tag</a> in Twig, you’ll have to install the <code>twig/cache-extra</code> package:</p><pre class="language-bash"><code class="language-bash"><span class="token function">composer</span> require twig/cache-extra</code></pre><p>And register it in Timber like this:</p><p><strong>functions.php</strong></p><pre class="language-php"><code class="language-php"><span class="token keyword">use</span> <span class="token package">Symfony<span class="token punctuation">\</span>Component<span class="token punctuation">\</span>Cache<span class="token punctuation">\</span>Adapter<span class="token punctuation">\</span>FilesystemAdapter</span><span class="token punctuation">;</span><br><span class="token keyword">use</span> <span class="token package">Symfony<span class="token punctuation">\</span>Component<span class="token punctuation">\</span>Cache<span class="token punctuation">\</span>Adapter<span class="token punctuation">\</span>TagAwareAdapter</span><span class="token punctuation">;</span><br><span class="token keyword">use</span> <span class="token package">Twig<span class="token punctuation">\</span>Extra<span class="token punctuation">\</span>Cache<span class="token punctuation">\</span>CacheExtension</span><span class="token punctuation">;</span><br><span class="token keyword">use</span> <span class="token package">Twig<span class="token punctuation">\</span>Extra<span class="token punctuation">\</span>Cache<span class="token punctuation">\</span>CacheRuntime</span><span class="token punctuation">;</span><br><span class="token keyword">use</span> <span class="token package">Twig<span class="token punctuation">\</span>RuntimeLoader<span class="token punctuation">\</span>RuntimeLoaderInterface</span><span class="token punctuation">;</span><br><br><span class="token function">add_filter</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'timber/twig'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$twig</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>		<span class="token variable">$twig</span><span class="token operator">-></span><span class="token function">addRuntimeLoader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">implements</span> <span class="token class-name">RuntimeLoaderInterface</span><br>		<span class="token punctuation">{</span><br>			<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">load</span><span class="token punctuation">(</span><span class="token variable">$class</span><span class="token punctuation">)</span><br>			<span class="token punctuation">{</span><br>				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name static-context">CacheRuntime</span><span class="token operator">::</span><span class="token keyword">class</span> <span class="token operator">===</span> <span class="token variable">$class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>					<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CacheRuntime</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TagAwareAdapter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FilesystemAdapter</span><span class="token punctuation">(</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token constant">TIMBER_LOC</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/cache/twig'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>				<span class="token punctuation">}</span><br>			<span class="token punctuation">}</span><br>		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>		<span class="token variable">$twig</span><span class="token operator">-></span><span class="token function">addExtension</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">CacheExtension</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">return</span> <span class="token variable">$twig</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>You can then use it like this:</p><pre class="language-twig"><code class="language-twig"><span class="token twig language-twig"><span class="token delimiter punctuation">{%</span> <span class="token tag-name keyword">cache</span> <span class="token string"><span class="token punctuation">'</span>index;content<span class="token punctuation">'</span></span> <span class="token delimiter punctuation">%}</span></span><br>    <span class="token twig language-twig"><span class="token delimiter punctuation">{%</span> <span class="token tag-name keyword">for</span> post <span class="token operator">in</span> posts <span class="token delimiter punctuation">%}</span></span><br>        <span class="token twig language-twig"><span class="token delimiter punctuation">{%</span> <span class="token tag-name keyword">include</span> <span class="token punctuation">[</span><span class="token string"><span class="token punctuation">'</span>tease-<span class="token punctuation">'</span></span> <span class="token operator">~</span> post<span class="token punctuation">.</span>post_type <span class="token operator">~</span> <span class="token string"><span class="token punctuation">'</span>.twig<span class="token punctuation">'</span></span><span class="token punctuation">,</span> <span class="token string"><span class="token punctuation">'</span>tease.twig<span class="token punctuation">'</span></span><span class="token punctuation">]</span> <span class="token delimiter punctuation">%}</span></span><br>    <span class="token twig language-twig"><span class="token delimiter punctuation">{%</span> <span class="token tag-name keyword">endfor</span> <span class="token delimiter punctuation">%}</span></span><br><span class="token twig language-twig"><span class="token delimiter punctuation">{%</span> <span class="token tag-name keyword">endcache</span> <span class="token delimiter punctuation">%}</span></span></code></pre><p>Read more about it in <a href="https://twig.symfony.com/doc/3.x/tags/cache.html">Twig’s <code>cache</code> documentation</a>.</p><p>If you want to use something meaningful for the cache key, you can also generate a cache key from the variables that you use. In the following example, we generate a cache key from <code>$posts</code> and then generate a key from it:</p><pre class="language-php"><code class="language-php"><span class="token variable">$generator</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">Timber<span class="token punctuation">\</span>Cache<span class="token punctuation">\</span>KeyGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token variable">$key</span> <span class="token operator">=</span> <span class="token variable">$generator</span><span class="token operator">-></span><span class="token function">generateKey</span><span class="token punctuation">(</span><span class="token variable">$posts</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3 id="extra-timberkeygeneratorinterface" tabindex="-1">Extra: TimberKeyGeneratorInterface <a class="directLink" href="#extra-timberkeygeneratorinterface">#</a></h3><p>Instead of hashing a whole object, you can specify the cache key in the object itself. If the object implements <code>TimberKeyGeneratorInterface</code>, it can pass a unique key through the method <code>get_cache_key()</code>. That way a class could for example pass a <code>'last_updated'</code> property as the unique key. If arrays contain the key <code>_cache_key</code>, that one is used as cache key.</p><p>This may save yet another few processor cycles.</p><h2 id="cache-the-php-data" tabindex="-1">Cache the PHP data <a class="directLink" href="#cache-the-php-data">#</a></h2><p>Sometimes the most expensive parts of the operations are generating the data needed to populate the twig template. You can of course use WordPress’s default <a href="https://codex.wordpress.org/Transients_API">Transient API</a> to store this data.</p><p>You can also use some <a href="https://en.wikipedia.org/wiki/Syntactic_sugar">syntactic sugar</a> to make the checking/saving/retrieving of transient data a bit easier:</p><p><strong>home.php</strong></p><pre class="language-php"><code class="language-php"><span class="token variable">$context</span> <span class="token operator">=</span> <span class="token class-name static-context">Timber</span><span class="token operator">::</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token variable">$context</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'main_stories'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name static-context">TimberHelper</span><span class="token operator">::</span><span class="token function">transient</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'main_stories'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token variable">$posts</span> <span class="token operator">=</span> <span class="token class-name static-context">Timber</span><span class="token operator">::</span><span class="token function">get_posts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// As an example, do something expensive with these posts</span><br>    <span class="token variable">$extra_teases</span> <span class="token operator">=</span> <span class="token function">get_field</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'my_extra_teases'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'options'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$extra_teases</span> <span class="token keyword">as</span> <span class="token operator">&amp;</span><span class="token variable">$tease</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token variable">$tease</span> <span class="token operator">=</span> <span class="token class-name static-context">Timber</span><span class="token operator">::</span><span class="token function">get_post</span><span class="token punctuation">(</span><span class="token variable">$tease</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token variable">$main_stories</span> <span class="token operator">=</span> <span class="token punctuation">[</span><br>        <span class="token string single-quoted-string">'posts'</span> <span class="token operator">=></span> <span class="token variable">$posts</span><span class="token punctuation">,</span><br>        <span class="token string single-quoted-string">'extra_teases'</span> <span class="token operator">=></span> <span class="token variable">$extra_teases</span><span class="token punctuation">,</span><br>    <span class="token punctuation">]</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">return</span> <span class="token variable">$main_stories</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">600</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token class-name static-context">Timber</span><span class="token operator">::</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'home.twig'</span><span class="token punctuation">,</span> <span class="token variable">$context</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Here <code>main_stories</code> is a totally made-up variable. It could be called <code>foo</code>, <code>bar</code>, <code>elephant</code>, etc.</p><h2 id="measuring-performance" tabindex="-1">Measuring Performance <a class="directLink" href="#measuring-performance">#</a></h2><p>Some tools like Debug Bar may not properly measure performance because its data (as in, the actual HTML it’s generating to tell you the timing, number of queries, etc.) is swept-up by the page’s cache.</p><p>Timber provides some quick shortcuts to measure page timing. Here’s an example of them in action:</p><p><strong>single.php</strong></p><pre class="language-php"><code class="language-php"><span class="token comment">// This generates a starting time</span><br><span class="token variable">$start</span> <span class="token operator">=</span> <span class="token class-name class-name-fully-qualified static-context">Timber<span class="token punctuation">\</span>Helper</span><span class="token operator">::</span><span class="token function">start_timer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token variable">$context</span> <span class="token operator">=</span> <span class="token class-name static-context">Timber</span><span class="token operator">::</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token punctuation">[</span><br>    <span class="token string single-quoted-string">'whatever'</span> <span class="token operator">=></span> <span class="token function">get_my_foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token class-name static-context">Timber</span><span class="token operator">::</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'single.twig'</span><span class="token punctuation">,</span> <span class="token variable">$context</span><span class="token punctuation">,</span> <span class="token number">600</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// This reports the time diff by passing the $start time</span><br><span class="token keyword">echo</span> <span class="token class-name class-name-fully-qualified static-context">Timber<span class="token punctuation">\</span>Helper</span><span class="token operator">::</span><span class="token function">stop_timer</span><span class="token punctuation">(</span><span class="token variable">$start</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2 id="important-notes" tabindex="-1">Important notes <a class="directLink" href="#important-notes">#</a></h2><ul><li>Never use <code>{% spaceless %}</code> tags to minify your HTML output. These tags are only meant to control whitespace between html tags.</li></ul></div></article></main></div></div><script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script><script>docsearch({
    appId: '7REN4GR6X4',
    apiKey: '9acbf22ef9a9b117a0f9ba50bd2f4280',
    /**
     * Timber config.
     *
     * @link https://github.com/algolia/docsearch-configs/blob/master/configs/timber.json
     */
    indexName: 'timber',
    container: '#docsearch',
    /**
     * Filter for different doc versions.
     *
     * @link https://www.algolia.com/doc/api-reference/api-parameters/facetFilters/
     */
    searchParameters: {
      facetFilters: ['version:v2']
    },
    // Set debug to true if you want to inspect the dropdown.
    // debug: true
  })</script></body></html>